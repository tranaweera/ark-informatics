SET FOREIGN_KEY_CHECKS=0;
ALTER TABLE `biocollection` MODIFY COLUMN `DIAG_CATEGORY`  text CHARACTER SET latin1 COLLATE latin1_swedish_ci NULL AFTER `SURGERYDATE`;
ALTER TABLE `biocollection` DROP FOREIGN KEY `fk_collection_study`;
ALTER TABLE `biocollection` ADD CONSTRAINT `fk_collection_study` FOREIGN KEY (`STUDY_ID`) REFERENCES `study`.`study` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `biocollection` DROP FOREIGN KEY `fk_collection_link_subject_study`;
ALTER TABLE `biocollection` ADD CONSTRAINT `fk_collection_link_subject_study` FOREIGN KEY (`LINK_SUBJECT_STUDY_ID`) REFERENCES `study`.`link_subject_study` (`ID`) ON DELETE CASCADE ON UPDATE NO ACTION;
ALTER TABLE `biospecimen` ADD COLUMN `OLDPARENT_ID`  int(11) NULL DEFAULT NULL AFTER `OLD_ID`;
ALTER TABLE `biospecimen` MODIFY COLUMN `TIMESTAMP`  varchar(55) CHARACTER SET latin1 COLLATE latin1_swedish_ci NULL DEFAULT NULL ;
ALTER TABLE `biospecimen` MODIFY COLUMN `DELETED`  int(11) NULL DEFAULT NULL AFTER `BIOSPECIMEN_STATUS_ID`;
ALTER TABLE `biospecimen` DROP FOREIGN KEY `fk_biospecimen_study`;
ALTER TABLE `biospecimen` ADD CONSTRAINT `fk_biospecimen_study` FOREIGN KEY (`STUDY_ID`) REFERENCES `study`.`study` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE `biospecimen` DROP FOREIGN KEY `fk_biospecimen_biocollection`;
ALTER TABLE `biospecimen` ADD CONSTRAINT `fk_biospecimen_biocollection` FOREIGN KEY (`BIOCOLLECTION_ID`) REFERENCES `biocollection` (`ID`) ON DELETE CASCADE ON UPDATE NO ACTION;
ALTER TABLE `biospecimen` DROP FOREIGN KEY `fk_biospecimen_biospecimen`;
ALTER TABLE `biospecimen` ADD CONSTRAINT `fk_biospecimen_biospecimen` FOREIGN KEY (`PARENT_ID`) REFERENCES `biospecimen` (`ID`) ON DELETE CASCADE ON UPDATE NO ACTION;
CREATE INDEX `fk_biospecimen_old_id` USING BTREE ON `biospecimen`(`OLD_ID`);
CREATE INDEX `fk_biospecimen_subject` USING BTREE ON `biospecimen`(`LINK_SUBJECT_STUDY_ID`);
ALTER TABLE `bio_transaction` MODIFY COLUMN `TRANSACTION_DATE`  datetime NULL DEFAULT NULL AFTER `BIOSPECIMEN_ID`;
ALTER TABLE `inv_box` ADD COLUMN `OLD_ID`  int(11) NULL DEFAULT NULL AFTER `TYPE`;
ALTER TABLE `inv_cell` ADD COLUMN `BIOSPECIMENKEY`  int(11) NULL DEFAULT NULL AFTER `BIOSPECIMEN_ID`;
ALTER TABLE `inv_rack` ADD COLUMN `OLD_ID`  int(11) NULL DEFAULT NULL AFTER `CAPACITY`;